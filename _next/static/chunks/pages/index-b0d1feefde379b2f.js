(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(5550)}])},5550:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var s=a(5893),r=a(7294),i=a(5152),l=a.n(i),n=a(4976);let o=l()(()=>a.e(276).then(a.bind(a,9276)),{loadableGenerated:{webpack:()=>[9276]},ssr:!1,loading:()=>(0,s.jsx)("div",{className:"flex items-center justify-center h-full bg-gray-100",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(n.Z,{className:"w-16 h-16 mx-auto mb-4 text-gray-400 animate-pulse"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Loading interactive map..."})]})})});var c=a(9557),d=a(6348),u=a(4195),h=a(3023),m=a(5358),x=a(9427),v=a(9114),p=a(2090),b=a(758),g=a(1222),y=a(1352),DynamicInfoSystem=e=>{let{reservoir:t,onClose:a,onZoomToReservoir:i}=e,[l,n]=(0,r.useState)(null),[o,f]=(0,r.useState)(!0),[j,w]=(0,r.useState)(null),[N,k]=(0,r.useState)("all");(0,r.useEffect)(()=>{t&&t.INDEX&&loadTimeSeriesData(t.INDEX,t.commission_year)},[t]);let loadTimeSeriesData=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;f(!0),w(null);try{let a=["".concat(e,"_").concat(t||"2010","_2025.csv"),"".concat(e,"_2010_2025.csv"),"".concat(e,".csv"),"reservoir_".concat(e,".csv")],s=null,r=null;for(let e of a)try{console.log("Trying to load: /data/dynamicData/".concat(e));let t=await fetch("/data/dynamicData/".concat(e));if(t.ok){s=await t.text(),r=e,console.log("Successfully loaded: ".concat(e));break}}catch(t){console.log("Failed to load ".concat(e,":"),t.message)}if(!s)throw Error("Unable to find time series data files for INDEX ".concat(e,". Tried: ").concat(a.join(", ")));let i=s.trim().split("\n"),l=i[0].split(",").map(e=>e.trim()),o=i.slice(1).map(e=>{let t=e.split(","),a={};return l.forEach((e,s)=>{var r;let i=null===(r=t[s])||void 0===r?void 0:r.trim();"Time"===e?a[e]=i:a[e]=i&&""!==i?parseFloat(i):null}),a});console.log("Loaded ".concat(o.length," data points from ").concat(r)),n(o)}catch(e){console.error("Error loading time series data:",e),w(e.message)}finally{f(!1)}},C=[{key:"elevation",title:"Water Level (m)",dataKey:"elevation_m",color:"#3b82f6",icon:p.Z,unit:"m"},{key:"area",title:"Surface Area (km\xb2)",dataKey:"area_km2",color:"#10b981",icon:b.Z,unit:"km\xb2"},{key:"storage",title:"Storage Change (MCM)",dataKey:"changed_storage_mcm",color:"#f59e0b",icon:g.Z,unit:"MCM"}],S=(0,r.useMemo)(()=>{if(!l)return null;if("all"===N)return l;let e=new Date,t=new Date;switch(N){case"1year":t.setFullYear(e.getFullYear()-1);break;case"2years":t.setFullYear(e.getFullYear()-2);break;case"5years":t.setFullYear(e.getFullYear()-5);break;default:return l}return l.filter(e=>{let a=new Date(e.Time);return a>=t})},[l,N]),CustomTooltip=e=>{let{active:t,payload:a,label:r}=e;return t&&a&&a.length?(0,s.jsxs)("div",{className:"bg-white p-3 border border-gray-200 rounded-lg shadow-lg",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-2",children:r}),a.map((e,t)=>(0,s.jsx)("p",{className:"text-sm",style:{color:e.color},children:null!==e.value?"".concat(e.value.toFixed(2)," ").concat(e.payload.unit||""):"No data"},t))]}):null};return o?(0,s.jsx)("div",{className:"h-full bg-white flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Loading dynamic data..."})]})}):j?(0,s.jsx)("div",{className:"h-full bg-white flex items-center justify-center p-6",children:(0,s.jsxs)("div",{className:"text-center max-w-lg",children:[(0,s.jsxs)("div",{className:"mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Unable to Load Dynamic Data"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:j})]}),(0,s.jsx)("div",{className:"mt-6 space-x-3",children:(0,s.jsxs)("button",{onClick:a,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors inline-flex items-center space-x-2",children:[(0,s.jsx)(y.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"Close"})]})})]})}):(0,s.jsxs)("div",{className:"h-full bg-white flex flex-col",children:[(0,s.jsx)("div",{className:"flex-shrink-0 border-b border-gray-200 p-4",children:(0,s.jsxs)("div",{className:"flex justify-between items-start",children:[(0,s.jsx)("div",{className:"flex-1",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-sm text-gray-600",children:[t.commission_year&&(0,s.jsxs)("span",{children:["Commission Year: ",t.commission_year]}),S&&(0,s.jsxs)("span",{children:[S.length," data points"]})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"text-sm border border-gray-300 rounded px-2 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500",children:[(0,s.jsx)("option",{value:"all",children:"All Data"}),(0,s.jsx)("option",{value:"1year",children:"Last 1 Year"}),(0,s.jsx)("option",{value:"2years",children:"Last 2 Years"}),(0,s.jsx)("option",{value:"5years",children:"Last 5 Years"})]}),(0,s.jsxs)("button",{onClick:a,className:"px-3 py-1 bg-gray-500 text-white text-sm rounded hover:bg-gray-600 transition-colors inline-flex items-center space-x-1",children:[(0,s.jsx)(y.Z,{className:"w-3 h-3"}),(0,s.jsx)("span",{children:"Close"})]})]})]})}),(0,s.jsx)("div",{className:"flex-1 p-4",children:(0,s.jsx)("div",{className:"flex space-x-3 h-full",children:C.map((e,t)=>{var a;return(0,s.jsxs)("div",{className:"flex-1 bg-gray-50 rounded-lg border border-gray-200 p-3 min-w-0",children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,s.jsxs)("h4",{className:"text-xs font-medium text-gray-700 flex items-center space-x-1",children:[(0,s.jsx)(e.icon,{className:"w-3 h-3 flex-shrink-0"}),(0,s.jsx)("span",{className:"truncate",children:e.title})]})}),(0,s.jsx)("div",{className:"h-52",children:(0,s.jsx)(c.h,{width:"100%",height:"100%",children:(0,s.jsxs)(d.w,{data:S,margin:{top:5,right:5,left:5,bottom:5},children:[(0,s.jsx)(u.q,{strokeDasharray:"3 3",stroke:"#e5e7eb",opacity:.5}),(0,s.jsx)(h.K,{dataKey:"Time",tick:{fontSize:10,fill:"#6b7280"},tickLine:{stroke:"#9ca3af"},axisLine:{stroke:"#9ca3af"},interval:"preserveStartEnd",tickFormatter:e=>{try{let t=new Date(e);return t.toLocaleDateString("en-US",{month:"short",year:"2-digit"})}catch(t){return e}}}),(0,s.jsx)(m.B,{tick:{fontSize:10,fill:"#6b7280"},tickLine:{stroke:"#9ca3af"},axisLine:{stroke:"#9ca3af"},tickFormatter:e=>"number"==typeof e?e.toFixed(1):e}),(0,s.jsx)(x.u,{content:(0,s.jsx)(CustomTooltip,{})}),(0,s.jsx)(v.x,{type:"monotone",dataKey:e.dataKey,stroke:e.color,strokeWidth:2,dot:!1,connectNulls:!1,activeDot:{r:3,fill:e.color,strokeWidth:2,stroke:"#ffffff"}})]})})}),(0,s.jsx)("div",{className:"mt-1 text-center",children:(0,s.jsxs)("span",{className:"text-xs text-gray-500",children:["Latest:"," ",S&&S.length>0?(null===(a=S[S.length-1][e.dataKey])||void 0===a?void 0:a.toFixed(2))+" ".concat(e.unit):"No data"]})})]},e.key)})})})]})};let ResponsiveNavbar=e=>{let{options:t,updateOption:a,onSidebarToggle:i=null,sidebarOpen:l=!0}=e,[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let handleResize=()=>{let e=window.innerWidth<768;o(e),e||d(!1)};return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]);let handleOverviewClick=e=>{a("overview",e),n&&d(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"dash-top-container bg-white shadow-sm border-b",children:[(0,s.jsxs)("div",{className:"dash-top-left",children:[(0,s.jsx)("div",{className:"header-logo--container flex items-center",children:(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"SEA-WEA"})}),n&&i&&(0,s.jsx)("button",{className:"mobile-sidebar-toggle p-2 text-gray-600 hover:text-gray-800 focus:outline-none",onClick:i,"aria-label":l?"Close sidebar":"Open sidebar",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),n&&(0,s.jsx)("button",{className:"mobile-menu-button p-2 text-gray-600 hover:text-gray-800 focus:outline-none",onClick:()=>d(!c),"aria-label":"Toggle navigation menu",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:c?"M6 18L18 6M6 6l12 12":"M12 5v.01M12 12v.01M12 19v.01"})})})]}),!n&&(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"dash-top-buttons flex space-x-2",children:[(0,s.jsx)("button",{className:"dash-top-button px-4 py-2 rounded transition-all duration-200 ".concat("current"===t.overview?"bg-blue-500 text-white active":"border border-gray-300 text-gray-700 hover:bg-gray-50"),onClick:()=>handleOverviewClick("current"),children:"Current"}),(0,s.jsx)("button",{className:"dash-top-button px-4 py-2 rounded transition-all duration-200 ".concat("future"===t.overview?"bg-blue-500 text-white active":"border border-gray-300 text-gray-700 hover:bg-gray-50"),onClick:()=>handleOverviewClick("future"),children:"Future"})]}),(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition-colors",children:"Overview"}),(0,s.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition-colors",children:"Methods"}),(0,s.jsx)("button",{className:"px-4 py-2 border border-gray-300 rounded text-gray-700 hover:bg-gray-50 transition-colors",children:"About Us"})]})]})]}),n&&(0,s.jsx)("div",{className:"mobile-menu-container bg-white border-b shadow-lg transition-all duration-300 ".concat(c?"max-h-96 opacity-100":"max-h-0 opacity-0 overflow-hidden"),children:(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Time Period:"}),(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("button",{className:"flex-1 py-2 px-3 rounded text-sm transition-all duration-200 ".concat("current"===t.overview?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"),onClick:()=>handleOverviewClick("current"),children:"Current"}),(0,s.jsx)("button",{className:"flex-1 py-2 px-3 rounded text-sm transition-all duration-200 ".concat("future"===t.overview?"bg-blue-500 text-white":"border border-gray-300 text-gray-700"),onClick:()=>handleOverviewClick("future"),children:"Future"})]})]}),(0,s.jsxs)("div",{className:"border-t pt-3 space-y-2",children:[(0,s.jsx)("button",{className:"w-full text-left py-2 px-3 text-gray-700 hover:bg-gray-50 rounded transition-colors",onClick:()=>d(!1),children:"Overview"}),(0,s.jsx)("button",{className:"w-full text-left py-2 px-3 text-gray-700 hover:bg-gray-50 rounded transition-colors",onClick:()=>d(!1),children:"Methods"}),(0,s.jsx)("button",{className:"w-full text-left py-2 px-3 text-gray-700 hover:bg-gray-50 rounded transition-colors",onClick:()=>d(!1),children:"About Us"})]})]})})]})},AttributeSelector=e=>{let{options:t,updateOption:a}=e,[i,l]=(0,r.useState)(!0),n={reservoirs:[{key:"dam_height_m",label:"Dam Height"},{key:"dam_length_m",label:"Dam Length"},{key:"normal_capacity_mcm",label:"Normal Capacity"},{key:"normal_area_km2",label:"Normal Area"},{key:"main_use",label:"Main Use"}],hydropower:[{key:"water_head_m",label:"Water Head"},{key:"power_mw",label:"Installed Capacity"}]},o=n[t.activeTab]||n.reservoirs,handleAttributeSelect=e=>{a("selectedAttribute",e)};return(0,s.jsx)("div",{className:"variable-selector",children:(0,s.jsxs)("div",{className:"variable-section",children:[(0,s.jsxs)("button",{className:"section-title",onClick:()=>l(!i),children:["Attributes",(0,s.jsx)("span",{className:"toggle-icon ".concat(i?"open":"closed"),children:"▼"})]}),i&&(0,s.jsx)("div",{className:"variable-list",children:o.map(e=>(0,s.jsx)("button",{className:"variable-item ".concat(t.selectedAttribute===e.key?"selected":""),onClick:()=>handleAttributeSelect(e.key),children:e.label},e.key))})]})})},CriticalitySelector=e=>{let{options:t,updateOption:a}=e,[i,l]=(0,r.useState)(!0);return(0,s.jsx)("div",{className:"variable-selector",children:(0,s.jsxs)("div",{className:"variable-section",children:[(0,s.jsxs)("button",{className:"section-title",onClick:()=>l(!i),children:["Layers",(0,s.jsx)("span",{className:"toggle-icon ".concat(i?"open":"closed"),children:"▼"})]}),i&&(0,s.jsxs)("div",{className:"variable-list",style:{padding:"8px 0"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 6px",marginBottom:"4px"},children:[(0,s.jsx)("input",{type:"checkbox",id:"show-critical",checked:t.showCritical,onChange:e=>a("showCritical",e.target.checked),style:{marginRight:"8px"}}),(0,s.jsxs)("label",{htmlFor:"show-critical",style:{cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},children:[(0,s.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:"#ef4444",borderRadius:"50%",marginRight:"6px"}}),"Critical (","reservoirs"===t.activeTab?">100MCM":">30MW",")"]})]}),(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"4px 6px"},children:[(0,s.jsx)("input",{type:"checkbox",id:"show-non-critical",checked:t.showNonCritical,onChange:e=>a("showNonCritical",e.target.checked),style:{marginRight:"8px"}}),(0,s.jsxs)("label",{htmlFor:"show-non-critical",style:{cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},children:[(0,s.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:"#3b82f6",borderRadius:"50%",marginRight:"6px"}}),"Non-critical (","reservoirs"===t.activeTab?"<100MCM":"0-30MW",")"]})]})]})]})})},SpatialUnitSelector=e=>{let{options:t,updateOption:a}=e,[i,l]=(0,r.useState)(!0);return(0,s.jsx)("div",{className:"variable-selector",children:(0,s.jsxs)("div",{className:"variable-section",children:[(0,s.jsxs)("button",{className:"section-title",onClick:()=>l(!i),children:["Spatial Unit",(0,s.jsx)("span",{className:"toggle-icon ".concat(i?"open":"closed"),children:"▼"})]}),i&&(0,s.jsx)("div",{className:"variable-list",children:[{value:"basins",label:"Basins"},{value:"countries",label:"Countries"}].map(e=>(0,s.jsx)("button",{className:"variable-item ".concat(t.spatialUnit===e.value?"selected":""),onClick:()=>a("spatialUnit",e.value),children:e.label},e.value))})]})})},WaterEnergySelector=e=>{let{options:t,updateOption:a}=e,[i,l]=(0,r.useState)(!0);return(0,s.jsx)("div",{className:"variable-selector",children:(0,s.jsxs)("div",{className:"variable-section",children:[(0,s.jsxs)("button",{className:"section-title",onClick:()=>l(!i),children:["Water",(0,s.jsx)("span",{className:"toggle-icon ".concat(i?"open":"closed"),children:"▼"})]}),i&&(0,s.jsx)("div",{className:"variable-list",children:[{value:"reservoirs",label:"Reservoirs & Dams"},{value:"hydropower",label:"Hydropower Station"}].map(e=>(0,s.jsx)("button",{className:"variable-item ".concat(t.activeTab===e.value?"selected":""),onClick:()=>{a("activeTab",e.value),a("selectedAttribute",{reservoirs:"normal_capacity_mcm",hydropower:"water_head_m"}[e.value])},children:e.label},e.value))})]})})},SummaryToggleSelector=e=>{let{options:t,updateOption:a}=e,[i,l]=(0,r.useState)(!0);return(0,s.jsx)("div",{className:"variable-selector",children:(0,s.jsxs)("div",{className:"variable-section",children:[(0,s.jsxs)("button",{className:"section-title",onClick:()=>l(!i),children:["Summary",(0,s.jsx)("span",{className:"toggle-icon ".concat(i?"open":"closed"),children:"▼"})]}),i&&(0,s.jsxs)("div",{className:"variable-list",style:{padding:"8px 0"},children:[(0,s.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:"8px 6px",marginBottom:"4px"},children:[(0,s.jsx)("input",{type:"checkbox",id:"show-summary",checked:t.showSummary||!1,onChange:e=>a("showSummary",e.target.checked),style:{marginRight:"8px"}}),(0,s.jsxs)("label",{htmlFor:"show-summary",style:{cursor:"pointer",fontSize:"14px",display:"flex",alignItems:"center"},children:[(0,s.jsx)("span",{style:{display:"inline-block",width:"12px",height:"12px",backgroundColor:"#10b981",borderRadius:"2px",marginRight:"6px"}}),"Show Basin Summary"]})]}),(0,s.jsx)("div",{className:"text-xs text-gray-600",style:{padding:"4px 6px",fontStyle:"italic"},children:"Display aggregated data by basin with bar charts"})]})]})})},ResponsiveSidebar=e=>{let{options:t,updateOption:a,availableCountries:i=[],availableUses:l=[],sidebarOpen:n,setSidebarOpen:o,isMobile:c=!1}=e,[d,u]=(0,r.useState)(!c);return(0,r.useEffect)(()=>{let handleResize=()=>{let e=window.innerWidth<768;e&&n&&u(!1)};return window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[n]),(0,r.useEffect)(()=>{if(n){let e=setTimeout(()=>u(!0),150);return()=>clearTimeout(e)}u(!1)},[n]),(0,s.jsxs)("div",{className:"seawea-sidebar ".concat(n?"open":"collapsed"," transition-all duration-300 ease-in-out"),children:[!c&&(0,s.jsx)("button",{className:"sidebar-toggle-btn",onClick:()=>o(!n),"aria-label":n?"Close sidebar":"Open sidebar",children:(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transition-transform duration-200 ".concat(n?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,s.jsxs)("div",{className:"sidebar-content ".concat(d?"visible":"hidden"," transition-opacity duration-200 overflow-y-auto"),children:[n&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(SpatialUnitSelector,{options:t,updateOption:a}),(0,s.jsx)(WaterEnergySelector,{options:t,updateOption:a}),(0,s.jsx)(CriticalitySelector,{options:t,updateOption:a}),(0,s.jsx)(SummaryToggleSelector,{options:t,updateOption:a}),(0,s.jsx)(AttributeSelector,{options:t,updateOption:a})]}),!n&&!c&&(0,s.jsx)("div",{className:"collapsed-hint",children:(0,s.jsx)("div",{className:"transform -rotate-90 text-xs text-gray-500 whitespace-nowrap",children:"Filters"})})]})]})};var Dashboard_ReservoirDashboard=()=>{var e,t,i,l;let[n,c]=(0,r.useState)({features:[],summary:{},metadata:{filters:{countries:[],main_uses:[]}}}),[d,u]=(0,r.useState)(!0),[h,m]=(0,r.useState)(null),[x,v]=(0,r.useState)(null),[p,b]=(0,r.useState)(!0),[g,y]=(0,r.useState)(!1),[f,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(null),[k,C]=(0,r.useState)(null),S=(0,r.useRef)(null),[_,E]=(0,r.useState)({activeTab:"reservoirs",spatialUnit:"basins",selectedCountries:[],selectedUses:[],selectedAttribute:"normal_capacity_mcm",showCritical:!0,showNonCritical:!0,showSummary:!1,overview:"current",dateType:"current"}),{overviewMode:M,filteredData:R,modeConfig:T,stats:D,basinSystem:L}=function(e,t){let[s,i]=(0,r.useState)((null==t?void 0:t.overview)||"current"),[l,n]=(0,r.useState)(null);(0,r.useEffect)(()=>{(null==t?void 0:t.overview)!==s&&i(t.overview||"current")},[null==t?void 0:t.overview]),(0,r.useEffect)(()=>{let initBasinSystem=async()=>{let{getBasinSystem:e}=await a.e(72).then(a.bind(a,3072)),t=await e();n(t)};initBasinSystem()},[]);let o=(0,r.useMemo)(()=>{let t=function(e,t){if(!e||!Array.isArray(e))return[];let a={current:["Operational"],future:["Under_construction","Planned"]}[t];if(!a)return console.warn("未知的overview模式: ".concat(t)),e;let s=e.filter(e=>!!e.status&&a.includes(e.status));return s}(e,s);return l&&t.length>0?l.assignBasinsBatch(t):t},[e,s,l]),c=(0,r.useMemo)(()=>(function(e){let t={current:{title:"Current Water Infrastructure",description:"Operational reservoirs and hydropower stations",statuses:["Operational"],statusColors:{Operational:"#22C55E"},mapMarkerColor:"#22C55E",chartTheme:"current"},future:{title:"Future Water Infrastructure",description:"Planned and under-construction projects",statuses:["Under_construction","Planned"],statusColors:{Under_construction:"#F59E0B",Planned:"#3B82F6"},mapMarkerColor:"#F59E0B",chartTheme:"future"}};return t[e]||t.current})(s),[s]),d=(0,r.useMemo)(()=>{if(!o.length)return null;let e=function(e){let t={};return e.forEach(e=>{let a=e.status||"Unknown";t[a]=(t[a]||0)+1}),t}(o),t=l?l.getBasinStats(o):{};return{total:o.length,statusStats:e,basinStats:t,criticalReservoirs:o.filter(e=>e.is_critical_reservoir).length,criticalHydropower:o.filter(e=>e.is_critical_hydropower).length}},[o,l]);return{overviewMode:s,filteredData:o,modeConfig:c,stats:d,basinSystem:l}}(n.features,_);(0,r.useEffect)(()=>{let handleResize=()=>{let e=window.innerWidth<768;y(e),e?b(!1):b(!0)};return handleResize(),window.addEventListener("resize",handleResize),()=>window.removeEventListener("resize",handleResize)},[]);let updateOption=(e,t)=>{E(a=>({...a,[e]:t})),("showSummary"===e||"overview"===e)&&(m(null),v(null),"overview"===e&&(j(!1),N(null),C(null)))},loadReservoirMask=async e=>{try{let t=await fetch("/data/criticalReservoirsShape/reservoir_".concat(e,".geojson"));if(t.ok){let e=await t.json();C(e)}}catch(e){console.error("Failed to load reservoir mask:",e)}};(0,r.useEffect)(()=>{fetch("/data/processed_critical_reservoirs.json").then(e=>e.json()).then(e=>{c(e),u(!1)}).catch(e=>{console.error("Error loading data:",e),u(!1)})},[]);let O=(0,r.useMemo)(()=>R?R.filter(e=>{let t="reservoirs"===_.activeTab?e.is_critical_reservoir:e.is_critical_hydropower;return(!!_.showCritical||!t)&&(!!_.showNonCritical||!!t)}):[],[R,_]);return d?(0,s.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading SEA-WEA Dashboard..."})]})}):(0,s.jsxs)("div",{className:"flex flex-col h-screen bg-gray-50",children:[(0,s.jsx)(ResponsiveNavbar,{options:_,updateOption:updateOption,onSidebarToggle:()=>{b(!p)},isMobile:g,modeConfig:T}),(0,s.jsxs)("div",{className:"flex flex-1 overflow-hidden",children:[(0,s.jsx)(ResponsiveSidebar,{options:_,updateOption:updateOption,availableCountries:(null===(t=n.metadata)||void 0===t?void 0:null===(e=t.filters)||void 0===e?void 0:e.countries)||[],availableUses:(null===(l=n.metadata)||void 0===l?void 0:null===(i=l.filters)||void 0===i?void 0:i.main_uses)||[],sidebarOpen:p,setSidebarOpen:b,isMobile:g}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col relative transition-all duration-300 ".concat(g?"ml-0":p?"ml-80":"ml-16"),children:[(0,s.jsx)("div",{className:"transition-all duration-300 ".concat(f?"h-1/2":"flex-1"),children:(0,s.jsx)(o,{ref:S,activeTab:_.activeTab,filteredData:O,selectedAttributes:[_.selectedAttribute],showCritical:_.showCritical,showNonCritical:_.showNonCritical,spatialUnit:_.spatialUnit,showSummary:_.showSummary,onMarkerClick:e=>{console.log("Marker clicked:",e),v(null)},onBasinClick:e=>{v(e),m(null)},onDynamicInfoClick:e=>{N(e),j(!0),e.poly_id&&loadReservoirMask(e.poly_id)},reservoirMask:k,overviewMode:M,modeConfig:T})}),f&&w&&(0,s.jsx)("div",{className:"h-1/2 border-t border-gray-200 transition-all duration-300",children:(0,s.jsx)(DynamicInfoSystem,{reservoir:w,onClose:()=>{j(!1),N(null),C(null)},onZoomToReservoir:()=>{w&&S.current&&S.current.flyTo([w.latitude,w.longitude],12)}})})]})]})]})};function Home(){return(0,s.jsx)(Dashboard_ReservoirDashboard,{})}}},function(e){e.O(0,[520,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);